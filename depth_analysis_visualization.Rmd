---
title: "Multi-Model Visualization"
output: html_notebook
---

```{r}
#loading libraries
library(readr)
library(ggplot2)
```

Summary of following CSV input files:
The CSV spline_model_test_resids.csv contains test-set residuals from the general additive model using natural splines.

The CSV ml_min_mc_resids.csv contains test-set residuals from the linear model using features ML and Mc2, in which we specify that the coefficient values are +1 and -1, respectively. 

The CSV named fourfeatureOLS_resids.csv contains the test-set residuals from our lasso model, which selected four parameters as the best predictors of depth.

Finally, the CSV named baseline_resids.csv contains the test-set residuals if we used the baseline, or average depth value, as a predictor of depth.

As before, cleaned_testing_df.csv contains the test set. 
```{r}
#input files
input.gam.resids = "C:/Users/riley/ds_portfolio/spline_model_test_resids.csv"
input.ols.resids = "C:/Users/riley/ds_portfolio/ml_min_mc_resids.csv"
input.4paramols.resids = "C:/Users/riley/ds_portfolio/fourfeatureOLS_resids.csv"
input.baseline.resids = "C:/Users/riley/ds_portfolio/baseline_resids.csv"
input.test = "C:/Users/riley/Seismo_Direc/cleaned_testing_df.csv"
```

```{r}
#reading in the data
test <- read.csv(input.test)
depths <- test$Dep

gam.resids <- read.csv(input.gam.resids)
colnames(gam.resids)[1] = "index"
colnames(gam.resids)[2] = "resid"

ols.resids <- read.csv(input.ols.resids)
colnames(ols.resids)[1] = "index"
colnames(ols.resids)[2] = "resid"

ols4.resids <- read.csv(input.4paramols.resids)
colnames(ols4.resids)[1] = "index"
colnames(ols4.resids)[2] = "resid"

baseline.resids <- read.csv(input.baseline.resids)
colnames(baseline.resids)[1] = "index"
colnames(baseline.resids)[2] = "resid"

#add all residual data frames to a master dataframe for use in plotting
df <- data.frame(depths, 
                 gam.resids$resid,
                 ols.resids$resid,
                 ols4.resids$resid,
                 baseline.resids$resid)
colnames(df)[2] = "gam_resids"
colnames(df)[3] = "ols_resids"
colnames(df)[4] = "ols4_resids"
colnames(df)[5] = "baseline_resids"
```

I'd like to include residula percentile lines on each of the subplots.
```{r}
#make some data to go on the x axis, from the minimum to maximum depths
x_dat <- min(depths):max(depths)

#I'm interested in the 10th, 50th, and 90th percentiles
probas <- c(0.1, 0.5, 0.9)

#calculate the percentiles for each model
percentiles_baseline <- quantile(df$baseline_resids, probs = probas)
percentiles_ols <- quantile(df$ols_resids, probs = probas)
percentiles_4ols <- quantile(df$ols4_resids, probs = probas)
percentiles_gam <- quantile(df$gam_resids, probs = probas)

```

Constructing the Plot
```{r}
#some plotting quantities
a = 0.08
c = "darkblue"
s = 16
ya = -14
yb = 24

#p1 plots the baseline residuals and their percentiles
p1 <- ggplot(data = df, 
             mapping = aes(x = depths,
                           y = baseline_resids)) +
  geom_point(alpha = a, color = c) +
  rremove("ylab") + rremove("xlab") +
  ggtitle("Baseline") +
  theme(axis.text = element_text(size = s), title = element_text(size = s)) +
  ylim(ya,yb) + 
  geom_hline(yintercept=percentiles_baseline[1], 
             linetype = "dashed", 
             color = "orangered") +
  geom_hline(yintercept = percentiles_baseline[2],
             linetype = "dashed",
             color = "violetred2") +
  geom_hline(yintercept = percentiles_baseline[3],
             linetype = "dashed",
             color = "darkorchid")

#p2 plots the OLS residuals and their percentiles
p2 <- ggplot(data = df, 
             mapping = aes(x = depths, 
                           y = ols_resids)) +
    geom_point(alpha = a, color = c) +
    rremove("ylab") + rremove("xlab") +
    ggtitle("ML - Mc2") +
    theme(axis.text=element_text(size=s),
          title=element_text(size=s)) +
    ylim(ya,yb) +
    geom_hline(yintercept=percentiles_ols[1], 
               linetype="dashed", color = "orangered") +
    geom_hline(yintercept=percentiles_ols[2], 
               linetype="dashed", color = "violetred2") +
    geom_hline(yintercept=percentiles_ols[3], 
               linetype="dashed", color = "darkorchid") 

#p3 plots the four-feature OLS residuals and their percentiles
p3 <- ggplot(data = df, 
             mapping = aes(x = depths,
                           y = ols4_resids)) +
    geom_point(alpha = a, color = c) +
    rremove("ylab") + rremove("xlab") +
    ggtitle("Four-Feature Least Squares") +
    theme(axis.text=element_text(size=s),
          title=element_text(size=s))+
    ylim(ya,yb) +
    geom_hline(yintercept=percentiles_4ols[1], 
               linetype="dashed", color = "orangered") +
    geom_hline(yintercept=percentiles_4ols[2], 
               linetype="dashed", color = "violetred2") +
    geom_hline(yintercept=percentiles_4ols[3], 
               linetype="dashed", color = "darkorchid") 

#p4 plots the general additive model residuals and their percentiles
p4 <- ggplot(data = df, 
             mapping = aes(x = depths, 
                           y = gam_resids)) +
    geom_point(alpha = a, color = c) +
    rremove("ylab") + rremove("xlab") +
    ggtitle("Natural Spline GAM") +
    theme(axis.text=element_text(size=s),
          title=element_text(size=s)) +
    ylim(ya,yb)+
    geom_hline(yintercept=percentiles_gam[1], 
               linetype="dashed", color = "orangered") +
    geom_hline(yintercept=percentiles_gam[2], 
               linetype="dashed", color = "violetred2") +
    geom_hline(yintercept=percentiles_gam[3], 
               linetype="dashed", color = "darkorchid") 
```

```{r}

```

